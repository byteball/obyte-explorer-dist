import{j as _e,_ as P,a as le,b as V,E as te,h as me,u as ve,k as he,l as ye,i as ke}from"./meta.Okm9vfaK.js";import{C as M,I as ge,J as xe,o as t,c as u,r as m,f as D,h as e,g as H,w,F as L,t as h,d as I,b as v,j,K as be,k as N,E as we,i as oe,L as $e,a as p,M as re,m as $,N as Ae,q as De,s as C,z as ie,B as Oe,x as Se,D as Ie,u as Ne,O as Le,P as Te,Q as Re,H as Be}from"./entry.yZmcPIhL.js";import{u as Ve,B as je,i as We,a as Pe,b as Ee,c as Fe,d as qe,g as E,S as ze,_ as Ce,e as Me}from"./AADescription.hdBstfR5.js";import{P as ue,_ as He}from"./AAResponses.YoXkG6p4.js";import"./nuxt-link.CJOVtHHj.js";function se(_,i){const n={};return _.query.asset&&(n.asset=_.query.asset),i&&i.value&&(n.lastInputsROWID=i.value.lastInputsROWID,n.lastOutputsROWID=i.value.lastOutputsROWID),n}const Ue=["innerHTML"],Ge={__name:"AddLinksToAddresses",props:{text:String},setup(_){const i=M();function n(s){return s.replace(/&quot;([A-Z0-9]{32})&quot;/g,function(a,g){return`&quot;<a class="addr link link-hover text-blue-500" href="/address/${g}">${g}</a>&quot;`})}function c(s){const{target:a}=s;a&&a.tagName==="A"&&a.className.includes("addr")&&(s.preventDefault(),i.push({path:`/address/${a.innerText}`}))}return ge(()=>{window.addEventListener("click",c,!0)}),xe(()=>{window.removeEventListener("click",c,!0)}),(s,a)=>(t(),u("div",{innerHTML:n(_.text)},null,8,Ue))}},Ye={__name:"BalancesChart",props:["name","data"],setup(_){Ve([We,Pe,Ee,Fe,qe]);const i=M(),n=_,c=m({tooltip:{trigger:"item",position:"top",formatter:function(a){return`${a.data.name} - $${_e(a.data.value)} (${a.percent}%)`}},series:[{name:n.name,type:"pie",radius:"80%",minShowLabelAngle:20,cursor:"default",label:{position:"inner",fontSize:11},labelLine:{show:!1},data:n.data,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]});function s(a){const{name:g,event:x}=a;x.target.type==="tspan"&&i.push(`/asset/${g}`)}return(a,g)=>(t(),D(e(je),{class:"chart",option:e(c),onClick:s},null,8,["option"]))}},Je={__name:"UnspentOutputs",props:["unspent"],setup(_){const{t:i}=H();return(n,c)=>(t(),D(V,{title:e(i)("unspent"),closed:!0},{default:w(()=>[be([_.unspent],()=>(t(),u("div",{class:"grid gap-1"},[(t(!0),u(L,null,j(_.unspent,s=>(t(),u("div",{key:s.output_id},[v(P,{type:"unit",link:s.unit},{default:w(()=>[I(h(s.unit),1)]),_:2},1032,["link"]),I(" Â ("),v(le,{amount:s.amount,decimals:s.assetDecimals,"is-asset":!0},null,8,["amount","decimals"]),v(P,{type:"asset",link:e(E)(s.asset,s.assetName)},{default:w(()=>[I(h(e(E)(s.asset,s.assetName)),1)]),_:2},1032,["link"]),I(") ")]))),128))])),c,0)]),_:1},8,["title"]))}},Xe={key:0,class:"mt-2 mb-4"},Ke={class:"text-xs ml-2"},Qe={class:"list-disc list-outside ml-5 sm:ml-10"},Ze={key:0},et={key:1},tt={class:"py-4"},ae=30,st={__name:"StateVars",props:["stateVars","storageSize"],setup(_){const i=_,{t:n}=H(),c=m(""),s=m([]),a=m(0);let g=0;function x(){g=0;const O=[];a.value=Object.keys(i.stateVars).length;for(let d in i.stateVars){if(g===ae)break;const f=String(i.stateVars[d]);if(!c.value||d.includes(c.value)||f.includes(c.value)){const k={key:d};try{k.type="json",k.value=De(Ae(f))}catch{k.type="text",k.value=f}O.push(k),g++}}s.value=O}return N(c,()=>{x()}),we(()=>{x()}),(O,d)=>(t(),u(L,null,[e(a)>ae?(t(),u("div",Xe,[oe(p("input",{class:"input input-bordered input-xs focus:outline-0",type:"text","onUpdate:modelValue":d[0]||(d[0]=f=>re(c)?c.value=f:null),placeholder:"Search"},null,512),[[$e,e(c)]]),p("span",Ke,h(e(n)("tooManyVars")),1)])):$("",!0),p("ul",Qe,[(t(!0),u(L,null,j(e(s),f=>(t(),u("li",{key:f.key},[p("span",null,h(f.key)+": ",1),f.type==="json"?(t(),u("div",Ze,[v(ue,null,{default:w(()=>[I(h(f.value),1)]),_:2},1024)])):(t(),u("span",et,h(f.value),1))]))),128))]),p("div",tt,h(e(n)("storageSize"))+": "+h(_.storageSize)+" bytes",1)],64))}};async function ne(_,i,n){const{wsConnected:c}=C(ie());let s="info";return n.lastInputsROWID&&(s="next_page"),c.value?(n.address=i,new Promise(a=>{if(s==="next_page"){_.emit(te.LoadNextPageAddressTransactions,n,a);return}_.emit(te.GetAddressData,n,a)})):await $fetch(`${Oe}/api/address/${i}/${s}`,{params:n})}const at={class:"w-full bg-white absolute h-full p-1 sm:p-4 pt-4",style:{"z-index":"1100"}},nt={class:"text-right pr-4"},lt={key:0,class:"text-center"},ot={key:1,class:"mt-14 text-center"},rt={key:2},it={class:"mt-10 font-bold"},ut={key:0,class:"font-normal text-sm"},ct=["href"],dt={class:"block lg:flex"},pt={class:"flex-auto"},ft={class:"list-disc list-outside ml-10"},_t={class:"pt-4 grid gap-1"},mt={class:"mt-4"},vt=["selected"],ht=["value","selected"],yt={class:"flex justify-center"},kt={__name:"Address",async setup(_){let i,n;const{lastUnit:c,view:s}=C(ie()),{rates:a}=C(Se()),{$socket:g}=Be(),{t:x}=H(),O=M(),d=Ie(),f=(d.params.address?`Address ${d.params.address} transactions and portfolio | `:"")+me;Ne({title:f,meta:[{name:"description",content:f},{name:"og:title",content:f},{name:"og:description",content:f},{name:"twitter:title",content:f},{name:"twitter:description",content:f}]});const k=m(!1),l=m({}),T=m(!1),F=m({lastInputsROWID:0,lastOutputsROWID:0}),R=m(!0),q=m(!1),A=m("all"),U=m(null),G=m(null),B=m([]),Y=m(!1),{height:J}=ve(),{height:z}=he(G),{y:X}=ye();function K(o){let y=[],S=null;if(!Object.keys(a.value).length)return[];for(let r in o){const b=o[r].balance;let ee=o[r].assetDecimals||0;const fe=o[r].assetName||"GBYTE";if(r==="bytes"&&(r="GBYTE",ee=9),!a.value[`${r}_USD`])continue;let W=b/10**ee;if(W=Number((a.value[`${r}_USD`]*W).toFixed(2)),r==="GBYTE"){S={value:W,name:"GBYTE"};continue}y.push({value:W,name:fe})}return y.sort((r,b)=>b.value-r.value),!S&&y.length&&(S={value:0,assetName:"GBYTE"}),S&&(y=[S,...y]),y}function ce(o){if(R.value=!0,q.value=!1,B.value=[],o.notFound){T.value=!0,k.value=!0;return}l.value=o,Y.value=!o.testnet&&o.arrAaResponses!==void 0,B.value=K(o.objBalances),F.value={lastInputsROWID:o.newLastInputsROWID,lastOutputsROWID:o.newLastOutputsROWID},T.value=!1,k.value=!0}function de(o){q.value=o.end,F.value={lastInputsROWID:o.newLastInputsROWID,lastOutputsROWID:o.newLastOutputsROWID},U.value.addNewTransactions(o.unitAssets,o.objTransactions),R.value=!0}async function Q(){if(!d.params.address)return;const o=se(d);d.query.asset&&(A.value=d.query.asset),k.value=!1;const y=await ne(g,d.params.address,o);ce(y)}async function Z(){if(q.value)return;const o=se(d,F);R.value=!1;const y=await ne(g,d.params.address,o);y.notFound||de(y)}[i,n]=Le(()=>Q()),await i,n(),N(()=>[d.params.address,d.query.asset||"all"].join("_"),Q),N(X,()=>{k.value&&R.value&&X.value+J.value+100>=z.value&&!T.value&&Z()}),N(z,()=>{k.value&&R.value&&z.value<J.value&&!T.value&&Z()}),N(A,()=>{A.value!==d.query.asset&&O.push({query:{asset:A.value}})}),N(a,()=>{l.value&&(B.value=K(l.value.objBalances))});function pe(){return c.value?O.push({path:"/"+c.value}):O.push({path:"/"})}return(o,y)=>{const S=ke;return t(),u("div",at,[p("div",{class:"max-w-6xl mx-auto w-full text-sm md:text-base",ref_key:"el",ref:G},[p("div",nt,[p("a",{onClick:pe,class:"link link-hover text-blue-500"},h(e(x)("closeButton")),1)]),e(k)?$("",!0):(t(),u("div",lt,[v(ze,{class:"w-20 h-20 inline-block"})])),e(T)?(t(),u("div",ot," No transactions were found for this address ")):e(k)?(t(),u("div",rt,[p("div",it,h(e(l).address),1),e(Y)?(t(),u("div",ut,[p("a",{href:"https://aa-stats.obyte.org/address/"+e(l).address,target:"_blank",class:"link link-hover text-blue-500"},"View Autonomous Agent stats (TVL, turnover) ",8,ct)])):$("",!0),v(S,null,{default:w(()=>[v(Ce,{definition:e(l).definition,baseAaDefinition:e(l).baseAaDefinition},null,8,["definition","baseAaDefinition"])]),_:1}),p("div",dt,[p("div",pt,[e(l).definition?(t(),D(V,{key:0,class:"pt-1.5",title:e(x)("labelDefinition"),closed:!0},{default:w(()=>[v(ue,null,{default:w(()=>[v(Ge,{text:e(Te)(JSON.parse(e(l).definition))},null,8,["text"])]),_:1})]),_:1},8,["title"])):$("",!0),e(l).objStateVars?(t(),D(V,{key:1,class:"pt-1.5",title:e(x)("labelStateVars"),closed:!0},{default:w(()=>[v(st,{"state-vars":e(l).objStateVars,"storage-size":e(l).storage_size},null,8,["state-vars","storage-size"])]),_:1},8,["title"])):$("",!0),e(l).arrAasFromTemplate?(t(),D(V,{key:2,class:"pt-1.5",title:e(x)("labelAasFromTemplate"),closed:!0},{default:w(()=>[p("ul",ft,[(t(!0),u(L,null,j(e(l).arrAasFromTemplate,r=>(t(),u("li",{key:r.address},[v(P,{type:"address",link:r.address},{default:w(()=>[I(h(r.address),1)]),_:2},1032,["link"])]))),128))])]),_:1},8,["title"])):$("",!0),e(l).arrAaResponses?(t(),D(V,{key:3,class:"pt-1.5",title:e(x)("labelAaResponses"),closed:!0},{default:w(()=>[v(He,{"arr-aa-responses":e(l).arrAaResponses},null,8,["arr-aa-responses"])]),_:1},8,["title"])):$("",!0),p("div",_t,[(t(!0),u(L,null,j(e(l).objBalances,(r,b)=>(t(),u("div",{key:b,class:"flex"},[v(le,{amount:r.balance,decimals:r.assetDecimals,"is-asset":!0,rates:!1},null,8,["amount","decimals"]),v(P,{type:"asset",link:e(E)(b,r.assetName)},{default:w(()=>[I(h(e(E)(b,r.assetName)),1)]),_:2},1032,["link"])]))),128))]),p("div",mt,[p("span",null,h(e(x)("transactionsInAssets"))+": ",1),oe(p("select",{class:"select select-bordered select-sm py-0","onUpdate:modelValue":y[0]||(y[0]=r=>re(A)?A.value=r:null)},[p("option",{value:"all",selected:e(A)==="all"},h(e(x)("labelAll")),9,vt),(t(!0),u(L,null,j(e(l).objAddressAssets,(r,b)=>(t(),u("option",{key:b,value:b,selected:e(A)===b},h(r.assetName||b),9,ht))),128))],512),[[Re,e(A)]])]),e(s)==="UTXO"?(t(),D(Je,{key:4,class:"mt-4",unspent:e(l).unspent},null,8,["unspent"])):$("",!0)]),p("div",yt,[e(B).length?(t(),D(Ye,{key:0,class:"h-80 w-80",data:e(B),name:"Balances"},null,8,["data"])):$("",!0)])]),v(Me,{class:"mt-12",ref_key:"PL",ref:U,"unit-assets":e(l).unitAssets,"obj-transactions":e(l).objTransactions,address:e(l).address,view:e(s)},null,8,["unit-assets","obj-transactions","address","view"])])):$("",!0)],512)])}}},At={__name:"[address]",setup(_){return(i,n)=>(t(),D(kt))}};export{At as default};
