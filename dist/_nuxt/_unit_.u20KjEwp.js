import{_ as st,a as nt}from"./AAResponses.Pi4sGE2q.js";import{o as c,f as E,b as f,_ as ye,g as ae,r as D,c as _,a as r,h as n,i as Ie,v as Be,t as u,F as U,j as F,n as X,w as b,d as k,k as Z,l as Le,m as B,q as me,s as O,x as ge,y as it,z as le,A as ot,B as at,C as He,D as Ae,E as Fe,G as Me,H as lt,p as rt,e as dt,u as ct}from"./entry.BCmlkwnc.js";import{_ as P,u as Re,a as J,b as C,c as ut,d as ft,e as Ee,g as pt,f as Ne,E as $,h as _t}from"./meta.lVxT3vs8.js";import"./nuxt-link._ssZLHl5.js";function ht(e,t){return c(),E("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor","aria-hidden":"true"},[f("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 11l3-3m0 0l3 3m-3-3v8m0-13a9 9 0 110 18 9 9 0 010-18z"})])}function yt(e,t){return c(),E("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor","aria-hidden":"true"},[f("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"})])}function mt(e,t){return c(),E("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor","aria-hidden":"true"},[f("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"})])}function gt(e,t){return c(),E("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor","aria-hidden":"true"},[f("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])}function bt(e,t){return c(),E("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor","aria-hidden":"true"},[f("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])}const xt={class:"up bottom-4 left-4"},wt={id:"content",class:"max-w-md w-full bg-white absolute p-6 rounded-lg"},vt={class:"font-bold text-xl mb-4"},kt={class:"grid gap-2"},$t={class:"sprite-legend sprite-1-1"},It={class:"sprite-legend sprite-2-1"},Bt={class:"sprite-legend sprite-3-1"},Et={class:"sprite-legend sprite-1-2"},Nt={class:"sprite-legend sprite-2-2"},Ct={class:"sprite-legend sprite-1-3"},Pt={class:"sprite-legend sprite-2-3"},St={class:"text-right"},Ut={__name:"ContentForLegend",setup(e){const{t}=ae(),o=D(!1);function l(){o.value=!0}function s(){o.value=!1}return(y,g)=>(c(),_(U,null,[r("div",xt,[r("button",{class:"btn btn-ghost btn-circle",onClick:l},[f(n(bt),{class:"h-10 w-10 text-blue-500 opacity-70 hover:opacity-90",style:{"margin-top":"-1px"}})])]),Ie(r("div",{class:"absolute inset-0 bg-black opacity-50",id:"bg",onClick:s},null,512),[[Be,n(o)]]),Ie(r("div",wt,[r("div",vt,u(n(t)("unitLegend")),1),r("div",kt,[r("div",$t,[r("span",null,"- "+u(n(t)("notMcNotStable")),1)]),r("div",It,[r("span",null,"- "+u(n(t)("mcNotStable")),1)]),r("div",Bt,[r("span",null,"- "+u(n(t)("badUnit")),1)]),r("div",Et,[r("span",null,"- "+u(n(t)("notMcFinal")),1)]),r("div",Nt,[r("span",null,"- "+u(n(t)("mcFinal")),1)]),r("div",Ct,[r("span",null,"- "+u(n(t)("notMcSelected")),1)]),r("div",Pt,[r("span",null,"- "+u(n(t)("mcSelected")),1)])]),r("div",St,[r("button",{class:"btn btn-ghost text-sm mt-4",onClick:s},u(n(t)("closeButton")),1)])],512),[[Be,n(o)]])],64))}},Tt=ye(Ut,[["__scopeId","data-v-f4376de3"]]),jt={class:"grid gap-1"},ue={__name:"ListLinks",props:["links","type"],setup(e){const t=e,o=D("/");return t.type==="address"&&(o.value+="address/"),(l,s)=>(c(),_("div",jt,[(c(!0),_(U,null,F(e.links,y=>(c(),_("div",{key:y,class:X({grid:e.type==="unit"})},[f(P,{type:e.type,link:y,class:X({"truncate max-w-95":e.type==="unit"})},{default:b(()=>[k(u(y),1)]),_:2},1032,["type","link","class"])],2))),128))]))}},Dt={__name:"Clipboard",props:{text:String},setup(e){const t=e,o=D(!0),l=D(!1),{width:s}=Re();Z(s,()=>{l.value=s.value<=500},{immediate:!0});function y(){o.value=!1,setTimeout(()=>{o.value=!0},5e3),navigator.clipboard.writeText(t.text).then(function(){console.log("clipboard:ok")},function(){console.log("clipboard:!ok")})}return(g,m)=>(c(),_("div",{onClick:y,class:X([{tooltip:n(o)&&!n(l)},""]),"data-tip":"Copy to clipboard"},[r("label",{class:X(["swap swap-rotate",{"swap-active":n(o),"cursor-default":!n(o)}])},[f(n(mt),{class:"swap-on text-blue-500 w-5"}),f(n(yt),{class:"swap-off w-5 text-green-500"})],2)],2))}},Ot={class:"pr-1 text-gray-600"},z={__name:"TIElement",props:{title:String},setup(e){return(t,o)=>(c(),_("div",null,[r("span",Ot,u(e.title)+":",1),r("span",null,[Le(t.$slots,"default")])]))}},Lt={class:"text-sm"},Ht=r("span",null,"Payment (",-1),At={key:1},Ft=r("span",null,")",-1),Mt={class:"font-bold"},Rt={key:0},zt=r("div",null,"Type: Issue",-1),Wt={class:"flex"},qt=r("span",null,"Amount: ",-1),Gt={key:1},Vt=r("span",{class:"inline-block"}," from ",-1),Jt={key:2},Yt={class:"inline-block"},Kt={class:"font-bold"},Qt=r("span",{class:"inline-block"}," to ",-1),Xt={key:0},Zt={__name:"Payment",props:["title","inputs","rates","outputsUnitByAsset","asset","assetName","assetDecimals"],setup(e){const{t}=ae();return(o,l)=>(c(),E(C,{"is-sub-collapse":!0},{title:b(()=>[r("div",Lt,[Ht,e.assetName!=="bytes"?(c(),E(P,{key:0,type:"asset",link:e.assetName},{default:b(()=>[k(u(e.assetName),1)]),_:1},8,["link"])):(c(),_("span",At,"bytes")),Ft])]),default:b(()=>[r("div",Mt,u(n(t)("labelInputs")),1),(c(!0),_(U,null,F(e.inputs,(s,y)=>(c(),_("div",{key:y},[s.type&&s.type==="issue"?(c(),_("div",Rt,[zt,r("div",null,"Serial number: "+u(s.serial_number),1),r("div",Wt,[qt,f(J,{amount:s.amount,"is-asset":e.asset!=="null",rates:e.rates,decimals:e.assetDecimals},null,8,["amount","is-asset","rates","decimals"])])])):s.output_index!==void 0&&s.to_obj?(c(),_("div",Gt,[f(J,{amount:s.to_obj.amount,"is-asset":e.asset!=="null",rates:e.rates,decimals:e.assetDecimals},null,8,["amount","is-asset","rates","decimals"]),Vt,f(P,{type:"unit",link:s.to_obj.unit},{default:b(()=>[k(u(s.to_obj.unit),1)]),_:2},1032,["link"])])):(s.type==="headers_commission"||s.type==="witnessing")&&s.obj_commissions?(c(),_("div",Jt,[f(J,{amount:s.obj_commissions.sum,"is-asset":e.asset!=="null",rates:e.rates,decimals:e.assetDecimals},null,8,["amount","is-asset","rates","decimals"]),r("span",Yt," of "+u(s.obj_commissions.obj_name)+" commissions on ",1),f(P,{type:"address",link:s.obj_commissions.address},{default:b(()=>[k(u(s.obj_commissions.address),1)]),_:2},1032,["link"]),r("span",null," from mci "+u(s.obj_commissions.from_mci)+" to mci "+u(s.obj_commissions.to_mci),1)])):B("",!0)]))),128)),r("div",Kt,u(n(t)("labelOutputs")),1),(c(!0),_(U,null,F(e.outputsUnitByAsset,s=>(c(),_("div",{key:s.output_id},[r("div",null,[f(J,{amount:s.amount,"is-asset":e.asset!=="null",rates:e.rates,decimals:e.assetDecimals},null,8,["amount","is-asset","rates","decimals"]),Qt,f(P,{type:"address",link:s.address},{default:b(()=>[k(u(s.address),1)]),_:2},1032,["link"])]),s.is_spent?(c(),_("div",Xt,[k(" (spent in "),f(P,{type:"unit",link:s.spent},{default:b(()=>[k(u(s.spent),1)]),_:2},1032,["link"]),k(") ")])):B("",!0)]))),128))]),_:1}))}},es={class:"whitespace-pre-wrap"},ts={class:"text-gray-500"},ss={key:0,style:{"word-break":"break-word"}},ns={key:1,style:{"word-break":"break-word"}},is={key:0},os={__name:"RawPayload",props:["title","unit","type","rawPayload"],setup(e){function t(o){return typeof o=="object"}return(o,l)=>(c(),E(C,{title:e.title,"is-sub-collapse":!0},{default:b(()=>[(c(!0),_(U,null,F(e.rawPayload,(s,y)=>(c(),_("div",{key:y},[r("div",es,[r("span",ts,u(y)+": ",1),t(s)?(c(),_("span",ss,u(n(me)(s)),1)):(c(),_("span",ns,u(s),1))])]))),128)),e.type==="asset"?(c(),_("div",is,[f(P,{type:"asset",link:e.unit},{default:b(()=>[k("Asset info")]),_:1},8,["link"])])):B("",!0)]),_:1},8,["title"]))}},as={key:0},ls={class:"flex"},rs={key:0},ds={key:1},cs={__name:"TransfersView",props:["message","existsOtherMessages"],setup(e){const t=e,{rates:o}=O(ge()),l=D([]);function s(g,m,i,h){Ee(m),Object.keys(m).length&&g.push({to:m,asset:i.asset,assetName:i.assetName,decimals:h,payload_hash:i.payload_hash})}function y(){const g=[];l.value=[],t.message.forEach(m=>{const i={from:{},to:{}};let h=m.assetDecimals||0;if(m.assetName==="bytes"&&(h=9),m.inputs.forEach(a=>{a.output_index!==void 0&&(i.from[a.to_obj.address]||(i.from[a.to_obj.address]=0),i.from[a.to_obj.address]+=a.to_obj.amount)}),m.outputsUnitByAsset.forEach(a=>{i.to[a.address]||(i.to[a.address]=0),i.to[a.address]+=a.amount}),ut(i.from,i.to),Object.keys(i.from).length===0){s(g,i.to,m,h);return}const x=Object.keys(i.to);if(x.length===1&&i.to[x[0]]===0){ft(i.from)&&Ee(i.from);for(let a in i.from)i.to[x[0]]+=i.from[a];s(g,i.to,m,h);return}s(g,i.to,m,h)}),l.value=g}return y(),Z(t.message,y),(g,m)=>(c(),_(U,null,[n(l).length?(c(),_("div",as,[f(C,{title:"Payments","is-sub-collapse":!0},{default:b(()=>[(c(!0),_(U,null,F(n(l),i=>(c(),_("div",{key:i.payload_hash},[(c(!0),_(U,null,F(i.to,(h,x)=>(c(),_("div",{key:x+"_"+i.payload_hash},[r("div",null,[f(P,{type:"address",link:x},{default:b(()=>[k(u(x),1)]),_:2},1032,["link"])]),r("div",ls,[f(J,{amount:h,"is-asset":i.asset!=="null",rates:n(o),decimals:i.decimals},null,8,["amount","is-asset","rates","decimals"]),i.asset!=="null"?(c(),_("span",rs,[f(P,{type:"asset",link:i.assetName},{default:b(()=>[k(u(i.assetName),1)]),_:2},1032,["link"])])):B("",!0)])]))),128))]))),128))]),_:1})])):B("",!0),!n(l).length&&!e.existsOtherMessages?(c(),_("div",ds,"none")):B("",!0)],64))}},re=it("info",{state:()=>({isReady:!1,info:{}}),getters:{authors:e=>e.info.authors?e.info.authors.map(t=>t.address):[]},actions:{setInfo(e){this.info=e},setReady(e){this.isReady=e}}}),us=r("span",{class:"text-gray-500"},"Address: ",-1),fs={key:0},ps={key:1},_s=r("span",{class:"text-gray-500"},"Definition: ",-1),hs={class:"whitespace-pre-wrap break-words"},ys={class:"whitespace-pre-wrap break-words text-sm"},ms={key:3,class:"text-gray-600 inline-flex align-middle bg-gray-100 w-full p-1"},gs={class:"text-sm"},bs={__name:"Messages",setup(e){const{info:t}=O(re()),{rates:o}=O(ge()),{view:l}=O(le()),{t:s}=ae(),y=D([]),g=D([]);function m(h){switch(h){case"payment":return s("appTypePayment");case"asset":return s("appTypeAsset");case"data":return s("appTypeData");case"data_feed":return s("appTypeDataFeed");case"profile":return s("appTypeProfile");case"attestation":return s("appTypeAttestation");case"poll":return s("appTypePoll");case"vote":return s("appTypeVote");case"text":return s("appTypeText");default:return h.substring(0,1).toUpperCase()+h.substring(1)}}function i(){const h=[];let x=!1;y.value=[],g.value=[],t.value.messages.forEach(a=>{if(!a.payload){a.app==="payment"&&a.payload_location==="none"&&!x&&(h.push({title:s("hiddenPayments"),type:"hidden",asset:"",payload_hash:a.payload_hash,assetName:"",assetDecimals:0,inputs:[],outputsUnitByAsset:[],address:"",rawPayload:{}}),x=!0);return}const p={title:m(a.app),type:a.app,asset:a.payload.asset||"null",payload_hash:a.payload_hash,assetName:a.payload.asset||"bytes",assetDecimals:0,inputs:[],outputsUnitByAsset:[],address:"",rawPayload:{}};if(a.payload.assetName&&(p.assetName=a.payload.assetName,p.assetDecimals=a.payload.assetDecimals||0),a.app==="payment")return p.inputs=a.payload.inputs.map(w=>{if(w.output_index!==void 0)w.to_obj=t.value.transfersInfo[w.unit+"_"+w.output_index+"_"+p.asset];else if(w.type==="headers_commission"||w.type==="witnessing"){const H=w.from_main_chain_index+"_"+w.to_main_chain_index,T=w.type==="headers_commission"?"headers":w.type==="witnessing"?"witnessing":!1;T&&(w.obj_commissions=t.value.assocCommissions[T][H],w.obj_commissions.obj_name=T)}return w}),p.outputsUnitByAsset=t.value.outputsUnit[p.asset],l.value==="Transfers"?g.value.push(p):h.push(p);if(a.app==="text")return p.text=a.payload,h.push(p);if(a.app==="definition")return p.isStable=!!t.value.is_stable,p.address=a.payload.address,p.json=me(a.payload.definition),h.push(p);p.rawPayload=a.payload,h.push(p)}),y.value=h}return i(),Z(l,()=>{i()}),(h,x)=>(c(),_("div",{class:"grid gap-y-3",key:n(l)+"_"+n(t).unit},[n(l)==="Transfers"?(c(),E(cs,{key:0,message:n(g),"exists-other-messages":!!n(y).length},null,8,["message","exists-other-messages"])):B("",!0),(c(!0),_(U,null,F(n(y),a=>(c(),_("div",{key:a.payload_hash},[a.type==="payment"?(c(),E(Zt,{key:0,title:a.title,inputs:a.inputs,"outputs-unit-by-asset":a.outputsUnitByAsset,rates:n(o),asset:a.asset,"asset-name":a.assetName,"asset-decimals":a.assetDecimals},null,8,["title","inputs","outputs-unit-by-asset","rates","asset","asset-name","asset-decimals"])):a.type==="definition"?(c(),E(C,{key:1,title:a.title,"is-sub-collapse":!0},{default:b(()=>[r("div",null,[us,a.isStable?(c(),_("span",fs,[f(P,{type:"address",link:a.address},{default:b(()=>[k(u(a.address),1)]),_:2},1032,["link"])])):(c(),_("span",ps,u(a.address),1))]),r("div",null,[_s,r("span",hs,u(a.json),1)])]),_:2},1032,["title"])):a.type==="text"?(c(),E(C,{key:2,title:a.title,"is-sub-collapse":!0},{default:b(()=>[r("pre",ys,u(a.text),1)]),_:2},1032,["title"])):a.type==="hidden"?(c(),_("div",ms,[Le(h.$slots,"title",{},()=>[r("span",gs,u(a.title),1)])])):(c(),E(os,{key:4,title:a.title,type:a.type,"raw-payload":a.rawPayload,unit:n(t).unit},null,8,["title","type","raw-payload","unit"]))]))),128))]))}},xs={key:0,class:"text-center"},ws={key:1,class:"p-1 sm:p-2"},vs={key:0,class:"text-center font-bold"},ks={class:"text-right py-2 px-4 xl:hidden"},$s={class:"text-sm text-gray-600"},Is={class:"text-sm"},Bs={class:"flex flex-wrap"},Es={class:"text-sm text-gray-600"},Ns={key:0},Cs={class:"text-sm text-gray-600"},Ps={key:1},Ss={class:"text-sm text-gray-600"},Us={class:"grid"},Ts={class:"grid sm:inline"},js={__name:"UnitInfo",setup(e){const{info:t,isReady:o}=O(re()),{rates:l}=O(ge()),{t:s}=ae(),{width:y}=Re(),g=D(!1),m=D("auto");Z(t,()=>{console.log(t.value),g.value=!1}),Z(y,()=>{m.value=y.value-40+"px"},{immediate:!0});function i(){g.value=!0}return(h,x)=>(c(),_("div",{class:X(["w-full xl:w-[34%] xl:block top-32 sm:top-24 lg:top-16 !border-0 sm:!border",{hidden:n(g)||!n(t).unit}]),id:"info"},[n(o)?B("",!0):(c(),_("div",xs,u(n(s)("selectUnit")),1)),n(o)?(c(),_("div",ws,[n(t).deleted?(c(),_("div",vs,u(n(s)("infoMessageUnitNotFound")),1)):B("",!0),n(t).unit?(c(),_("div",{key:n(t).unit,class:"grid gap-y-3 text-sm md:text-base"},[r("div",ks,[r("a",{class:"link link-hover text-blue-500",onClick:i},u(n(s)("closeButton")),1)]),r("div",null,[r("div",$s,u(n(s)("unitID")),1),r("div",Is,[r("div",Bs,[r("div",{class:"truncate",style:ot({maxWidth:n(m)})},u(n(t).unit),5),f(Dt,{class:"h-5 ml-1",style:{"padding-top":"1px"},text:n(t).unit},null,8,["text"])])])]),r("div",null,[r("div",Es,u(n(s)("received")),1),r("div",null,u(n(pt)(n(t).timestamp)),1)]),n(t).full_node_confirmation_delay?(c(),_("div",Ns,[r("div",Cs,u(n(s)("confDelayFull")),1),r("div",null,u(n(Ne)(n(t).full_node_confirmation_delay)),1)])):B("",!0),n(t).light_node_confirmation_delay?(c(),_("div",Ps,[r("div",Ss,u(n(s)("confDelayLight")),1),r("div",null,u(n(Ne)(n(t).light_node_confirmation_delay)),1)])):B("",!0),f(C,{title:n(s)("authors")},{default:b(()=>[(c(!0),_(U,null,F(n(t).authors,a=>(c(),_("div",{key:a.address},[f(P,{type:"address",link:a.address},{default:b(()=>[k(u(a.address),1)]),_:2},1032,["link"]),a.definition?(c(),E(C,{key:0,title:n(s)("labelDefinition"),"is-sub-collapse":!0,closed:!0,class:"whitespace-pre-wrap break-words"},{default:b(()=>[k(u(n(me)(JSON.parse(a.definition))),1)]),_:2},1032,["title"])):B("",!0)]))),128))]),_:1},8,["title"]),f(C,{title:n(s)("children")},{default:b(()=>[f(ue,{links:n(t).child,type:"unit"},null,8,["links"])]),_:1},8,["title"]),f(C,{title:n(s)("parents")},{default:b(()=>[f(ue,{links:n(t).parents,type:"unit"},null,8,["links"])]),_:1},8,["title"]),n(t).trigger_unit?(c(),E(C,{key:2,title:n(s)("triggerUnitID")},{default:b(()=>[r("div",Us,[f(P,{type:"unit",link:n(t).trigger_unit,class:"truncate max-w-95"},{default:b(()=>[k(u(n(t).trigger_unit),1)]),_:1},8,["link"])])]),_:1},8,["title"])):B("",!0),f(C,{title:n(s)("messages"),class:"pt-2"},{default:b(()=>[f(bs)]),_:1},8,["title"]),n(t).arrAaResponses?(c(),E(C,{key:3,class:"pt-1.5",title:n(s)("aaResponses"),closed:!1},{default:b(()=>[f(st,{"arr-aa-responses":n(t).arrAaResponses},null,8,["arr-aa-responses"])]),_:1},8,["title"])):B("",!0),f(C,{title:n(s)("witnesses"),closed:!0},{default:b(()=>[f(ue,{links:n(t).witnesses,type:"address"},null,8,["links"])]),_:1},8,["title"]),f(C,{title:n(s)("techInfo")},{default:b(()=>[f(z,{title:n(s)("labelFees")},{default:b(()=>[f(J,{amount:n(t).headers_commission+n(t).payload_commission,rates:n(l)},null,8,["amount","rates"]),k(" ("+u(n(t).headers_commission)+" "+u(n(s)("labelHeaders"))+", "+u(n(t).payload_commission)+" "+u(n(s)("labelPayload"))+") ",1)]),_:1},8,["title"]),f(z,{title:n(s)("labelLevel")},{default:b(()=>[k(u(n(t).level),1)]),_:1},8,["title"]),f(z,{title:n(s)("labelWitnessedLevel")},{default:b(()=>[k(u(n(t).witnessed_level),1)]),_:1},8,["title"]),n(t).last_ball_unit?(c(),E(z,{key:0,title:n(s)("labelLastBallUnit")},{default:b(()=>[r("div",Ts,[f(P,{link:n(t).last_ball_unit,type:"unit",class:"truncate max-w-95"},{default:b(()=>[k(u(n(t).last_ball_unit),1)]),_:1},8,["link"])])]),_:1},8,["title"])):B("",!0),f(z,{title:n(s)("labelMci")},{default:b(()=>[k(u(n(t).main_chain_index),1)]),_:1},8,["title"]),f(z,{title:n(s)("labelLatestMci")},{default:b(()=>[k(u(n(t).latest_included_mc_index),1)]),_:1},8,["title"]),f(z,{title:n(s)("labelIsStable")},{default:b(()=>[k(u(n(t).is_stable?n(s)("statusFinal"):n(s)("statusNotStable")),1)]),_:1},8,["title"])]),_:1},8,["title"])])):B("",!0)])):B("",!0)],2))}},Ds=ye(js,[["__scopeId","data-v-6d093ab4"]]),Os=[{selector:"node",style:{content:"data(unit_s)","text-opacity":1,"min-zoomed-font-size":13,"text-valign":"bottom","text-halign":"center","font-size":"13px","text-margin-y":"5px","background-color":"#fff","border-width":1,"border-color":"#2980b9",width:25,height:25}},{selector:"node.hover",style:{content:"data(id)","text-opacity":1,"font-weight":"bold","font-size":"14px","text-background-color":"#fff","text-background-opacity":1,"text-background-shape":"rectangle","text-border-opacity":1,"text-border-width":4,"text-border-color":"#fff","z-index":9999}},{selector:"edge",style:{width:2,"target-arrow-shape":"triangle","line-color":"#2980b9","target-arrow-color":"#2980b9","curve-style":"bezier"}},{selector:".best_parent_unit",style:{width:5,"target-arrow-shape":"triangle","line-color":"#2980b9","target-arrow-color":"#2980b9","curve-style":"bezier"}},{selector:".is_on_main_chain",style:{"background-color":"#9cc0da"}},{selector:".is_stable",style:{"border-width":4,"border-style":"solid","border-color":"#2980b9"}},{selector:".active",style:{"border-color":"#333","border-width":"4"}},{selector:".finalBad",style:{"background-color":"red"}},{selector:".tempBad",style:{"background-color":"red"}}];function ze(e){return e>500?e/(e/500):e<-500?-(e/(e/500)):e}function We(e){const t={};let o,l,s,y;for(o=0,s=e.length;o<s;o++)for(l=0;l<s;l++)o!==l&&e[o].position.x<e[l].position.x+10&&e[o].position.x>e[l].position.x-10&&e[o].position.y===e[l].position.y&&(t[e[o].position.y]||(t[e[o].position.y]=[]),t[e[o].position.y].push(e[o]));for(const g in t){let m=0;const i=[];for(l=0,y=t[g].length;l<y;l++)for(o=0;o<s;o++)e[o].data.id===t[g][l].data.id&&i.indexOf(e[o].data.id)===-1&&(i.push(e[o].data.id),e[o].position.x<0?m-=60:m+=60,e[o].position.x+=m)}return e}let d,v,V,ee,de,q={},G={},M=[],be,Y=0,se=-116,xe,K,L,A=!1,ie=!0,R=!1,we=!1,qe=0,pe=!1,ne=!1,W=[],fe=!1,_e=!1,he=!1,te=(e,t)=>{},ve=e=>{};function Ls(e){te=e}function Hs(e){ve=e}function As(e,t){v=e,V=t,ee=v[0].rowid,de=v[v.length-1].rowid,q={},G={},M=[],be=null,Y=0,se=-116,A=!1,ie=!0,K=null,L=null,Xe(),Ye(e,t),xe=d.getElementById(v[0].data.unit).position().y+66,d.viewport({zoom:1.01}),d.center(d.nodes()[0]),we=!0}function Fs(e){A=!0,ce(e)}const j=document.getElementById("scroll");window.addEventListener("resize",function(){j&&d&&(j.scrollTop=Q())});function Q(e,t){if(e||(e=d.pan("y")),t===void 0&&(t=qe),!!j)return j.offsetHeight/2-t-e}function ke(){d&&(M=[],d.nodes().forEach(function(e){e.hasClass("is_stable")||M.push(e.id())}))}function Ge(){const e=d.getCenterPan(d.getElementById(v[0].data.unit)).y,t=d.getCenterPan(d.getElementById(v[v.length-1].data.unit)).y;qe=Q(e,0),document.getElementById("scrollBody")&&j&&(document.getElementById("scrollBody").style.height=Q(t-e,0)+j.offsetHeight/2,setTimeout(function(){j.scrollTop=Q()},1))}function Ve(){const e={...V},t=d.edges(),o=t.length,l=[];let s,y="",g=0,m=0;for(let i=0,h=o;i<h;i++){const x=t[i].source()+"_"+t[i].target();e[x]&&delete e[x]}for(const i in q)d.getElementById(i).position("y",Y+166);for(const i in G)d.getElementById(i).position("y",se-166);for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(y="",y+=e[i].best_parent_unit?"best_parent_unit":"",d.getElementById(e[i].data.target).length?l.push({group:"edges",data:e[i].data,classes:y}):(s=d.getElementById(e[i].data.source).position(),q[e[i].data.target]=s.x+g,l.push({group:"nodes",data:{id:e[i].data.target,unit_s:e[i].data.target.substr(0,7)+"..."},position:{x:s.x+g,y:Y+166}}),g+=60,l.push({group:"edges",data:e[i].data,classes:y})),d.getElementById(e[i].data.source).length||(s=d.getElementById(e[i].data.target).position(),G[e[i].data.source]=s.x+m,l.push({group:"nodes",data:{id:e[i].data.source,unit_s:e[i].data.source.substr(0,7)+"..."},position:{x:s.x+m,y:se-166}}),m+=60,l.push({group:"edges",data:e[i].data,classes:y})));return l}function Je(e,t){const o=new window.dagre.graphlib.Graph({multigraph:!0,compound:!0});o.setGraph({}),o.setDefaultEdgeLabel(function(){return{}}),e.forEach(function(l){o.setNode(l.data.unit,{label:l.data.unit_s,width:32,height:32,is_on_main_chain:l.is_on_main_chain,is_stable:l.is_stable,sequence:l.sequence})});for(const l in t)Object.prototype.hasOwnProperty.call(t,l)&&o.setEdge(t[l].data.source,t[l].data.target);return window.dagre.layout(o),o}function Ye(e,t){let o,l,s=1/0,y=-1/0,g=!1,m=[],i,h="",x;const a=Je(e,t);a.nodes().forEach(function(p){i=a.node(p),i&&(i.x<s&&(s=i.x),i.x>y&&(y=i.x))}),a.nodes().forEach(function(p){i=a.node(p),i&&(h="",i.is_on_main_chain&&(h+="is_on_main_chain "),i.is_stable&&(h+="is_stable "),i.sequence==="final-bad"&&(h+="finalBad"),i.sequence==="temp-bad"&&(h+="tempBad"),g||(o=-i.x-(y-s)/2,l=Y-i.y+66,g=!0),q[p]!==void 0?(d.remove(d.getElementById(p)),m.push({group:"nodes",data:{id:p,unit_s:i.label},position:{x:q[p],y:i.y+l},classes:h}),delete q[p]):(x=ze(i.x+o),x===0&&i.is_on_main_chain===0&&(x+=40),m.push({group:"nodes",data:{id:p,unit_s:i.label},position:{x,y:i.y+l},classes:h})))}),m=We(m),d.add(m),Y=d.nodes()[d.nodes().length-1].position().y,be=Y,d.add(Ve()),ke(),Ge()}function Ke(){const e=d.extent();A===!1&&e.y2-e.h/2>d.getElementById(v[0].data.unit).position().y+20||A===!0&&e.y2-e.h>d.getElementById(v[0].data.unit).position().y?d.panBy({x:0,y:25}):A===!0&&oe()}function Qe(){d.panBy({x:0,y:-25})}function Ce(){this.addClass("hover")}function Pe(){this.removeClass("hover")}function Se(e){ve(e.cyTarget.id())}function Ue(e){ve(e.cyTarget.id())}function Te(){const e=d.extent();be<e.y2?Ms():A===!0&&e.y2-e.h<d.getElementById(v[0].data.unit).position().y&&oe(),j&&(j.scrollTop=Q())}function je(e){e.preventDefault();const t=e.deltaY||-e.deltaY;t<0?Ke():t>0&&Qe(),j&&(j.scrollTop=Q())}function Xe(){d&&(d.off("mouseover","node",Ce),d.off("mouseout","node",Pe),d.off("click","node",Se),d.off("tap","node",Ue),d.off("pan",Te),d.container().removeEventListener("wheel",je)),d=window.cytoscape({container:document.getElementById("cy"),boxSelectionEnabled:!1,autounselectify:!0,hideEdgesOnViewport:!1,layout:{name:"preset"},style:Os,elements:{nodes:[],edges:[]}}),d.on("mouseover","node",Ce),d.on("mouseout","node",Pe),d.on("click","node",Se),d.on("tap","node",Ue),d.on("pan",Te),d.container().addEventListener("wheel",je)}function $e(e){if(!e)return;let t;e.forEach(function(o){t=d.getElementById(o.unit),t&&(t.hasClass("is_stable")||t.addClass("is_stable"),o.is_on_main_chain===1&&!t.hasClass("is_on_main_chain")?t.addClass("is_on_main_chain"):o.is_on_main_chain===0&&t.hasClass("is_on_main_chain")&&t.removeClass("is_on_main_chain")),M.splice(M.indexOf(o.unit),1)}),ke()}function Ze(e){fe?W.push(e):(W.length>1&&(e=W.reduce(function(t,o){return t+o}),W=[]),d.stop(),fe=!0,d.animate({pan:{x:d.pan("x"),y:d.pan("y")+e}},{duration:250,complete:function(){xe=d.getElementById(v[0].data.unit).position().y+66,fe=!1,W.length&&(Ze(W[0]),W.splice(0,1))}}))}function et(e,t,o){let l,s,y=1/0,g=-1/0,m=1/0,i=-1/0,h=!1,x,a=[],p,w="",H;const T=Je(e,t);T.nodes().forEach(function(S){p=T.node(S),p&&(x=p.y,x<y&&(y=x),x>g&&(g=x),p.x<m&&(m=p.x),p.x>i&&(i=p.x))}),T.nodes().forEach(function(S){p=T.node(S),p&&(w="",p.is_on_main_chain&&(w+="is_on_main_chain "),p.is_stable&&(w+="is_stable "),p.sequence==="final-bad"&&(w+="finalBad"),p.sequence==="temp-bad"&&(w+="tempBad"),h||(l=-p.x-(i-m)/2,s=se-(g-y)+66,se-=g-y+66,h=!0,o&&d.extent().y1<xe&&Ze(g+54)),G[S]!==void 0?(d.remove(d.getElementById(S)),a.push({group:"nodes",data:{id:S,unit_s:p.label},position:{x:G[S],y:p.y+s},classes:w}),delete G[S]):(H=ze(p.x+l),H===0&&p.is_on_main_chain===0&&(H+=40),a.push({group:"nodes",data:{id:S,unit_s:p.label},position:{x:H,y:p.y+s},classes:w})))}),a=We(a),d.add(a),d.add(Ve()),ke(),Ge()}function Ms(){!pe&&we&&(te($.Next,{last:de,notStable:M}),pe=!0)}function oe(){!ne&&we&&(te($.Prev,{first:ee,notStable:M}),ne=!0)}function Rs(e){R||(te($.HighlightNode,{first:ee,last:de,unit:e}),R=!0)}function ce(e){te($.Info,{unit:e}),d||Xe(),K&&d.getElementById(K).removeClass("active");const t=d.getElementById(e);if(t.length&&q[e]===void 0&&G[e]===void 0){const o=d.extent(),l=t.position().y;if(t.addClass("active"),K=t.id(),l<o.y1||l>o.y2)return ne=!0,d.stop(),d.animate({pan:{x:d.pan("x"),y:d.getCenterPan(t).y},complete:function(){ne=!1,oe()}},{duration:250});L=!1,oe()}else L=e,Rs(L);return!1}function zs(e){As(e.nodes,e.edges),ie=!0,R&&(R=!1)}function De(e){if(ie){R&&(R=!1),v=v.concat(e.nodes);for(const t in e.edges)Object.prototype.hasOwnProperty.call(e.edges,t)&&(V[t]=e.edges[t]);de=v[v.length-1].rowid,Ye(e.nodes,e.edges),pe=!1,L&&(ce(L),L=!1),e.nodes.length===0&&(ie=!1),$e(e.arrStableUnits)}}function Oe(e){if(R&&(R=!1),e.nodes.length){v=[].concat(e.nodes,v);for(const t in e.edges)Object.prototype.hasOwnProperty.call(e.edges,t)&&(V[t]=e.edges[t]);ee=e.nodes[0].rowid,et(e.nodes,e.edges)}ne=!1,e.end===!0&&(A=!1),L&&(ce(L),L=!1),$e(e.arrStableUnits)}function Ws(e){if(!d)return;const t=d.getElementById(e);K===t.id()&&(K=null),v=v.filter(function(o){return o.data.unit!==e});for(const o in V)o.indexOf(e)>-1&&delete V[o];d.remove(t)}function qs(e){if(e.nodes.length){v=[].concat(e.nodes,v);for(const t in e.edges)Object.prototype.hasOwnProperty.call(e.edges,t)&&(V[t]=e.edges[t]);ee=v[0].rowid,et(e.nodes,e.edges,!0),he&&(he=!1,tt()),e.nodes.length>=100&&(A=!0)}_e=!1,$e(e.arrStableUnits)}function tt(){A||(_e?he=!0:(te($.New,{unit:ee,notStable:M}),_e=!0))}async function Gs(e,t){const{wsConnected:o}=O(le());return o.value?new Promise(l=>{e.emit($.Info,t,l)}):await $fetch(`${at}/api/unit/${encodeURIComponent(t)}`)}const Vs=e=>(rt("data-v-57fc6b2b"),e=e(),dt(),e),Js={class:"up top-40 sm:top-28 lg:top-20 right-[2%] xl:right-[35%]"},Ys=Vs(()=>r("span",{class:"text-gray-50"},"Unit not found",-1)),Ks={__name:"UnitMain",setup(e){const t=He(),o=Ae(),l=le(),s=re(),{searchInputFocused:y}=O(l),{info:g}=O(s),m=D(!1),i=D(),{$socket:h}=lt();function x(I){zs(I),o.params.unit&&Fs(o.params.unit)}function a(){m.value=!1,i.value&&clearTimeout(i.value)}async function p(I){if(g&&g.unit===I)return;const N=await Gs(h,I);N.deleted?(l.setLastUnit(""),Ws(I),m.value=!0,setTimeout(a,3e3),await t.push("/")):l.setLastUnit(N.unit),s.setInfo(N),s.setReady(!0)}function w({type:I,data:N}){switch(I){case $.Start:return x(N);case $.Prev:return Oe(N);case $.Next:return De(N);case $.NotFound:return}}Ls((I,N)=>{switch(I){case $.Info:return p(N.unit);case $.Prev:return h.emit($.Prev,N,Oe);case $.Next:return h.emit($.Next,N,De);case $.HighlightNode:return h.emit($.HighlightNode,N,w);case $.New:return h.emit($.New,N,qs)}}),Hs(I=>{I.startsWith("/")&&(I=I.replace("/","%2F")),t.push(`/${I}`)});function H(){s.setInfo({}),s.setReady(!1),l.setLastUnit(""),t.push("/"),T()}function T(){h.emit($.GetLastUnits,x)}h.on("update",tt);function S(I){y.value||(I.key==="ArrowUp"?(I.preventDefault(),Ke()):I.key==="ArrowDown"&&(I.preventDefault(),Qe()))}return Z(()=>o.params.unit,()=>{o.name==="home"&&(o.params.unit?ce(o.params.unit):H())}),Fe(()=>{if(window.addEventListener("keydown",S),o.params.unit){p(o.params.unit),h.emit($.GetUnit,{unit:o.params.unit},x);return}T()}),Me(()=>{window.removeEventListener("keydown",S)}),(I,N)=>(c(),_(U,null,[r("div",Js,[r("button",{class:"btn btn-ghost btn-circle tooltip tooltip-left","data-tip":"To most recent units",onClick:H},[f(n(ht),{class:"h-12 w-12 text-gray-700 opacity-70 hover:opacity-90",style:{"margin-top":"-1px"}})])]),r("div",{class:X(["alert alert-error shadow-lg absolute w-72 cursor-pointer",{alertShown:n(m)}]),onClick:a},[r("div",null,[f(n(gt),{class:"h-6 w-6 text-gray-50",style:{"margin-top":"-1px"}}),Ys])],2)],64))}},Qs=ye(Ks,[["__scopeId","data-v-57fc6b2b"]]),Xs=r("div",{id:"cy",class:"right-0 xl:right-[34%] overscroll-none"},null,-1),Zs=r("div",{id:"scroll",class:"right-0 xl:right-[34%] overscroll-none"},[r("div",{id:"scrollBody"}," ")],-1),on={__name:"[unit]",async setup(e){le();const t=re();O(t),He();const o=Ae(),l=(o.params.unit?`Unit ${o.params.unit} details on Obyte DAG chain | `:"")+_t;return ct({title:l,meta:[{name:"description",content:l},{name:"og:title",content:l},{name:"og:description",content:l},{name:"twitter:title",content:l},{name:"twitter:description",content:l}]}),Fe(()=>{document.body.classList.add("overscroll-none","overflow-hidden")}),Me(()=>{document.body.classList.remove("overscroll-none","overflow-hidden")}),(s,y)=>{const g=nt;return c(),_(U,null,[Xs,Zs,f(Tt),f(g,null,{default:b(()=>[f(Qs)]),_:1}),f(Ds)],64)}}};export{on as default};
