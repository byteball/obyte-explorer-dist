import{P as le,_ as me,a as ve}from"./AAResponses.Pi4sGE2q.js";import{C as H,I as he,J as ye,o as t,c as i,r as m,f as S,h as e,g as M,w as x,F as N,t as k,d as O,b as v,j,K as ke,k as L,E as be,i as oe,L as ge,a as _,M as ie,m as w,N as xe,q as we,s as C,z as re,B as Ae,O as ue,x as $e,D as De,u as Se,P as Oe,Q as Ie,H as Ne}from"./entry.BCmlkwnc.js";import{i as Le,_ as P,a as ce,b as V,E as te,h as Te,u as Re,j as Be,k as Ve}from"./meta.lVxT3vs8.js";import{u as je,B as We,i as Pe,a as Ee,b as Fe,c as qe,d as ze,g as E,S as Ce,_ as He}from"./Spinner.z74WhtTp.js";import{_ as Me}from"./nuxt-link._ssZLHl5.js";function se(f,r){const l={};return f.query.asset&&(l.asset=f.query.asset),r&&r.value&&(l.lastInputsROWID=r.value.lastInputsROWID,l.lastOutputsROWID=r.value.lastOutputsROWID),l}const Ue=["innerHTML"],Ge={__name:"AddLinksToAddresses",props:{text:String},setup(f){const r=H();function l(s){return s.replace(/&quot;([A-Z0-9]{32})&quot;/g,function(a,h){return`&quot;<a class="addr link link-hover text-blue-500" href="/address/${h}">${h}</a>&quot;`})}function u(s){const{target:a}=s;a&&a.tagName==="A"&&a.className.includes("addr")&&(s.preventDefault(),r.push({path:`/address/${a.innerText}`}))}return he(()=>{window.addEventListener("click",u,!0)}),ye(()=>{window.removeEventListener("click",u,!0)}),(s,a)=>(t(),i("div",{innerHTML:l(f.text)},null,8,Ue))}},Je={__name:"BalancesChart",props:["name","data"],setup(f){je([Pe,Ee,Fe,qe,ze]);const r=H(),l=f,u=m({tooltip:{trigger:"item",position:"top",formatter:function(a){return`${a.data.name} - $${Le(a.data.value)} (${a.percent}%)`}},series:[{name:l.name,type:"pie",radius:"80%",minShowLabelAngle:20,cursor:"default",label:{position:"inner",fontSize:11},labelLine:{show:!1},data:l.data,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]});function s(a){const{name:h,event:b}=a;b.target.type==="tspan"&&r.push(`/asset/${h}`)}return(a,h)=>(t(),S(e(We),{class:"chart",option:e(u),onClick:s},null,8,["option"]))}},Ye={__name:"UnspentOutputs",props:["unspent"],setup(f){const{t:r}=M();return(l,u)=>(t(),S(V,{title:e(r)("unspent"),closed:!0},{default:x(()=>[ke([f.unspent],()=>(t(),i("div",{class:"grid gap-1"},[(t(!0),i(N,null,j(f.unspent,s=>(t(),i("div",{key:s.output_id},[v(P,{type:"unit",link:s.unit},{default:x(()=>[O(k(s.unit),1)]),_:2},1032,["link"]),O(" Â ("),v(ce,{amount:s.amount,decimals:s.assetDecimals,"is-asset":!0},null,8,["amount","decimals"]),v(P,{type:"asset",link:e(E)(s.asset,s.assetName)},{default:x(()=>[O(k(e(E)(s.asset,s.assetName)),1)]),_:2},1032,["link"]),O(") ")]))),128))])),u,0)]),_:1},8,["title"]))}},Xe={key:0,class:"mt-2 mb-4"},Ke={class:"text-xs ml-2"},Qe={class:"list-disc list-outside ml-5 sm:ml-10"},Ze={key:0},et={key:1},tt={class:"py-4"},ae=30,st={__name:"StateVars",props:["stateVars","storageSize"],setup(f){const r=f,{t:l}=M(),u=m(""),s=m([]),a=m(0);let h=0;function b(){h=0;const $=[];a.value=Object.keys(r.stateVars).length;for(let o in r.stateVars){if(h===ae)break;const n=String(r.stateVars[o]);if(!u.value||o.includes(u.value)||n.includes(u.value)){const y={key:o};try{y.type="json",y.value=we(xe(n))}catch{y.type="text",y.value=n}$.push(y),h++}}s.value=$}return L(u,()=>{b()}),be(()=>{b()}),($,o)=>(t(),i(N,null,[e(a)>ae?(t(),i("div",Xe,[oe(_("input",{class:"input input-bordered input-xs focus:outline-0",type:"text","onUpdate:modelValue":o[0]||(o[0]=n=>ie(u)?u.value=n:null),placeholder:"Search"},null,512),[[ge,e(u)]]),_("span",Ke,k(e(l)("tooManyVars")),1)])):w("",!0),_("ul",Qe,[(t(!0),i(N,null,j(e(s),n=>(t(),i("li",{key:n.key},[_("span",null,k(n.key)+": ",1),n.type==="json"?(t(),i("div",Ze,[v(le,null,{default:x(()=>[O(k(n.value),1)]),_:2},1024)])):(t(),i("span",et,k(n.value),1))]))),128))]),_("div",tt,k(e(l)("storageSize"))+": "+k(f.storageSize)+" bytes",1)],64))}};async function ne(f,r,l){const{wsConnected:u}=C(re());let s="info";return l.lastInputsROWID&&(s="next_page"),u.value?(l.address=r,new Promise(a=>{if(s==="next_page"){f.emit(te.LoadNextPageAddressTransactions,l,a);return}f.emit(te.GetAddressData,l,a)})):await $fetch(`${Ae}/api/address/${r}/${s}`,{params:l})}const at={key:0,class:"mt-1"},nt={class:"mt-1"},lt={key:0,class:"inline-block"},ot={key:1,class:"ml-2 inline-block"},it={__name:"AADescription",props:["definition","baseAaDefinition"],async setup(f){let r,l;const u=f,s=m(""),a=m(""),h=m(""),b=async o=>{const n=await $fetch(o);n.description&&(s.value=n.description),n.homepage_url&&(a.value=n.homepage_url),n.source_url&&(h.value=n.source_url)},$=async()=>{try{const o=JSON.parse(u.definition);if(o[1].doc_url){await b(o[1].doc_url);return}if(u.baseAaDefinition){const n=JSON.parse(u.baseAaDefinition);n[1].doc_url&&await b(n[1].doc_url)}}catch{}};return[r,l]=ue(()=>$()),await r,l(),(o,n)=>{const y=Me;return t(),i(N,null,[e(s)?(t(),i("div",at,k(e(s)),1)):w("",!0),_("div",nt,[e(a)?(t(),i("div",lt,[v(y,{class:"link link-hover text-blue-500",to:e(a),target:"_blank"},{default:x(()=>[O(" Home page ")]),_:1},8,["to"])])):w("",!0),e(h)?(t(),i("div",ot,[v(y,{class:"link link-hover text-blue-500",to:e(h),target:"_blank"},{default:x(()=>[O(" Source ")]),_:1},8,["to"])])):w("",!0)])],64)}}},rt={class:"w-full bg-white absolute h-full p-1 sm:p-4 pt-4",style:{"z-index":"1100"}},ut={class:"text-right pr-4"},ct={key:0,class:"text-center"},dt={key:1,class:"mt-14 text-center"},pt={key:2},_t={class:"mt-10 font-bold"},ft={key:0,class:"font-normal text-sm"},mt=["href"],vt={class:"block lg:flex"},ht={class:"flex-auto"},yt={class:"list-disc list-outside ml-10"},kt={class:"pt-4 grid gap-1"},bt={class:"mt-4"},gt=["selected"],xt=["value","selected"],wt={class:"flex justify-center"},At={__name:"Address",async setup(f){let r,l;const{lastUnit:u,view:s}=C(re()),{rates:a}=C($e()),{$socket:h}=Ne(),{t:b}=M(),$=H(),o=De(),n=(o.params.address?`Address ${o.params.address} transactions and portfolio | `:"")+Te;Se({title:n,meta:[{name:"description",content:n},{name:"og:title",content:n},{name:"og:description",content:n},{name:"twitter:title",content:n},{name:"twitter:description",content:n}]});const y=m(!1),c=m({}),T=m(!1),F=m({lastInputsROWID:0,lastOutputsROWID:0}),R=m(!0),q=m(!1),D=m("all"),U=m(null),G=m(null),B=m([]),J=m(!1),{height:Y}=Re(),{height:z}=Be(G),{y:X}=Ve();function K(d){let g=[],I=null;if(!Object.keys(a.value).length)return[];for(let p in d){const A=d[p].balance;let ee=d[p].assetDecimals||0;const fe=d[p].assetName||"GBYTE";if(p==="bytes"&&(p="GBYTE",ee=9),!a.value[`${p}_USD`])continue;let W=A/10**ee;if(W=Number((a.value[`${p}_USD`]*W).toFixed(2)),p==="GBYTE"){I={value:W,name:"GBYTE"};continue}g.push({value:W,name:fe})}return g.sort((p,A)=>A.value-p.value),!I&&g.length&&(I={value:0,assetName:"GBYTE"}),I&&(g=[I,...g]),g}function de(d){if(R.value=!0,q.value=!1,B.value=[],d.notFound){T.value=!0,y.value=!0;return}c.value=d,J.value=!d.testnet&&d.arrAaResponses!==void 0,B.value=K(d.objBalances),F.value={lastInputsROWID:d.newLastInputsROWID,lastOutputsROWID:d.newLastOutputsROWID},T.value=!1,y.value=!0}function pe(d){q.value=d.end,F.value={lastInputsROWID:d.newLastInputsROWID,lastOutputsROWID:d.newLastOutputsROWID},U.value.addNewTransactions(d.unitAssets,d.objTransactions),R.value=!0}async function Q(){if(!o.params.address)return;const d=se(o);o.query.asset&&(D.value=o.query.asset),y.value=!1;const g=await ne(h,o.params.address,d);de(g)}async function Z(){if(q.value)return;const d=se(o,F);R.value=!1;const g=await ne(h,o.params.address,d);g.notFound||pe(g)}[r,l]=ue(()=>Q()),await r,l(),L(()=>[o.params.address,o.query.asset||"all"].join("_"),Q),L(X,()=>{y.value&&R.value&&X.value+Y.value+100>=z.value&&!T.value&&Z()}),L(z,()=>{y.value&&R.value&&z.value<Y.value&&!T.value&&Z()}),L(D,()=>{D.value!==o.query.asset&&$.push({query:{asset:D.value}})}),L(a,()=>{c.value&&(B.value=K(c.value.objBalances))});function _e(){return u.value?$.push({path:"/"+u.value}):$.push({path:"/"})}return(d,g)=>{const I=ve;return t(),i("div",rt,[_("div",{class:"max-w-6xl mx-auto w-full text-sm md:text-base",ref_key:"el",ref:G},[_("div",ut,[_("a",{onClick:_e,class:"link link-hover text-blue-500"},k(e(b)("closeButton")),1)]),e(y)?w("",!0):(t(),i("div",ct,[v(Ce,{class:"w-20 h-20 inline-block"})])),e(T)?(t(),i("div",dt," No transactions were found for this address ")):e(y)?(t(),i("div",pt,[_("div",_t,k(e(c).address),1),e(J)?(t(),i("div",ft,[_("a",{href:"https://aa-stats.obyte.org/address/"+e(c).address,target:"_blank",class:"link link-hover text-blue-500"},"View Autonomous Agent stats (TVL, turnover) ",8,mt)])):w("",!0),v(I,null,{default:x(()=>[v(it,{definition:e(c).definition,baseAaDefinition:e(c).baseAaDefinition},null,8,["definition","baseAaDefinition"])]),_:1}),_("div",vt,[_("div",ht,[e(c).definition?(t(),S(V,{key:0,class:"pt-1.5",title:e(b)("labelDefinition"),closed:!0},{default:x(()=>[v(le,null,{default:x(()=>[v(Ge,{text:e(Oe)(JSON.parse(e(c).definition))},null,8,["text"])]),_:1})]),_:1},8,["title"])):w("",!0),e(c).objStateVars?(t(),S(V,{key:1,class:"pt-1.5",title:e(b)("labelStateVars"),closed:!0},{default:x(()=>[v(st,{"state-vars":e(c).objStateVars,"storage-size":e(c).storage_size},null,8,["state-vars","storage-size"])]),_:1},8,["title"])):w("",!0),e(c).arrAasFromTemplate?(t(),S(V,{key:2,class:"pt-1.5",title:e(b)("labelAasFromTemplate"),closed:!0},{default:x(()=>[_("ul",yt,[(t(!0),i(N,null,j(e(c).arrAasFromTemplate,p=>(t(),i("li",{key:p.address},[v(P,{type:"address",link:p.address},{default:x(()=>[O(k(p.address),1)]),_:2},1032,["link"])]))),128))])]),_:1},8,["title"])):w("",!0),e(c).arrAaResponses?(t(),S(V,{key:3,class:"pt-1.5",title:e(b)("labelAaResponses"),closed:!0},{default:x(()=>[v(me,{"arr-aa-responses":e(c).arrAaResponses},null,8,["arr-aa-responses"])]),_:1},8,["title"])):w("",!0),_("div",kt,[(t(!0),i(N,null,j(e(c).objBalances,(p,A)=>(t(),i("div",{key:A,class:"flex"},[v(ce,{amount:p.balance,decimals:p.assetDecimals,"is-asset":!0,rates:!1},null,8,["amount","decimals"]),v(P,{type:"asset",link:e(E)(A,p.assetName)},{default:x(()=>[O(k(e(E)(A,p.assetName)),1)]),_:2},1032,["link"])]))),128))]),_("div",bt,[_("span",null,k(e(b)("transactionsInAssets"))+": ",1),oe(_("select",{class:"select select-bordered select-sm py-0","onUpdate:modelValue":g[0]||(g[0]=p=>ie(D)?D.value=p:null)},[_("option",{value:"all",selected:e(D)==="all"},k(e(b)("labelAll")),9,gt),(t(!0),i(N,null,j(e(c).objAddressAssets,(p,A)=>(t(),i("option",{key:A,value:A,selected:e(D)===A},k(p.assetName||A),9,xt))),128))],512),[[Ie,e(D)]])]),e(s)==="UTXO"?(t(),S(Ye,{key:4,class:"mt-4",unspent:e(c).unspent},null,8,["unspent"])):w("",!0)]),_("div",wt,[e(B).length?(t(),S(Je,{key:0,class:"h-80 w-80",data:e(B),name:"Balances"},null,8,["data"])):w("",!0)])]),v(He,{class:"mt-12",ref_key:"PL",ref:U,"unit-assets":e(c).unitAssets,"obj-transactions":e(c).objTransactions,address:e(c).address,view:e(s)},null,8,["unit-assets","obj-transactions","address","view"])])):w("",!0)],512)])}}},Nt={__name:"[address]",setup(f){return(r,l)=>(t(),S(At))}};export{Nt as default};
